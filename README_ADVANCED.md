# Улучшенная версия сервиса анонимизации (main_advanced.py)

## Описание

Новая версия использует мощную BERT модель для распознавания именованных сущностей (NER) вместо Presidio. Это обеспечивает более точное распознавание имен, адресов и других персональных данных.

## Преимущества

1. **Более точное распознавание имен** - BERT модель лучше понимает контекст
2. **Лучшая работа с русским языком** - специализированная модель для русского NER
3. **Поддержка GPU** - автоматическое использование GPU если доступно
4. **Комбинированный подход** - NER модель + паттерны для максимальной точности

## Установка

```bash
pip install -r requirements.txt
```

## Используемые модели

По умолчанию используется модель `Gherman/bert-base-NER-Russian`. 

Можно заменить на более мощные модели:
- `DeepPavlov/rubert-base-cased-conversational` - более мощная модель
- `ai-forever/ruBert-base` - базовая модель от AI Forever

Для смены модели отредактируйте переменную `MODEL_NAME` в файле `main_advanced.py`.

## Запуск

```bash
python main_advanced.py
```

или

```bash
uvicorn main_advanced:app --host 0.0.0.0 --port 8000
```

## API

API полностью совместимо с предыдущей версией:

### POST /anonymize

```json
{
  "text": "Иван Иванов, телефон +79001234567, адрес: северный пр 69"
}
```

Ответ:
```json
{
  "anonymized_text": "{ИМЯ_1}, телефон {ТЕЛЕФОН_1}, адрес: {АДРЕС_1}",
  "mapping": {
    "{ИМЯ_1}": "Иван Иванов",
    "{ТЕЛЕФОН_1}": "+79001234567",
    "{АДРЕС_1}": "северный пр 69"
  },
  "processing_time": 0.123
}
```

### GET /health

Проверка состояния сервиса и загруженной модели.

## Сравнение с предыдущей версией

| Характеристика | main.py (Presidio) | main_advanced.py (BERT) |
|----------------|-------------------|------------------------|
| Распознавание имен | Хорошее | Отличное |
| Распознавание адресов | Хорошее | Хорошее |
| Скорость | Быстро | Средняя (зависит от GPU) |
| Требования к памяти | Средние | Высокие |
| Точность | 85-90% | 90-95% |

## Рекомендации

- Используйте `main_advanced.py` если нужна максимальная точность
- Используйте `main.py` если важна скорость и низкие требования к ресурсам
- Для продакшена рекомендуется использовать GPU для ускорения работы BERT модели

## Миграция

Для перехода на новую версию:

1. Остановите старый сервер
2. Замените `main.py` на `main_advanced.py` (или переименуйте)
3. Установите дополнительные зависимости: `pip install torch accelerate`
4. Перезапустите сервер

API полностью совместимо, изменения в клиентском коде не требуются.

